/*! Built with http://stenciljs.com */
const{h:t}=window.postcomponent,s=$rdf.graph(),e=new $rdf.Fetcher(s),r=$rdf.Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),o=$rdf.Namespace("http://purl.org/dc/terms/"),a=$rdf.Namespace("http://www.w3.org/2006/vcard/ns#"),i=$rdf.Namespace("http://rdfs.org/sioc/ns#");class n{constructor(){this.updateManager=new $rdf.UpdateManager(s),this.profile={},this.createPost=(t=>{let s=this.webid.substring(0,this.webid.length-15)+"public",e=s+"/posts";fetch(e,{method:"GET"}).then(async t=>{200===t.status?await this.sendPostData(e,this.webid):404===t.status?(await this.createFolder(s),this.sendPostData(e,this.webid)):console.log(t.statusText)})}),this.getProfile=(async t=>await e.load(t)),this.sendPostData=(async(t,s)=>{let e=[],n=t+"/"+Date.now().toString(),d=$rdf.sym(n+"#author"),h=$rdf.sym(n+"#Post"),c=$rdf.sym(t),l=$rdf.sym(n);e.push($rdf.st(h,r("type"),i("Post"),c)),e.push($rdf.st(h,i("content"),$rdf.lit(this.postText.value.trim()),c)),e.push($rdf.st(h,i("has_creator"),d,c)),e.push($rdf.st(h,o("created"),$rdf.lit(new Date),c)),console.log(this.profile),this.profile&&(console.log("New author info"),e.push($rdf.st(d,a("fn"),$rdf.lit(this.profile.name))),e.push($rdf.st(d,i("avatar"),$rdf.sym(this.profile.image))),e.push($rdf.st(d,i("account_of"),$rdf.sym(this.webid)))),this.updateManager.put(l,e,"text/turtle",(t,s,e)=>{s?console.log("Success!"):(console.log("Error!"),console.log(e))})}),this.createFolder=(t=>{e.createContainer($rdf.sym(t),"posts")})}async componentDidLoad(){await this.getProfile(this.webid),this.profile.name=s.any($rdf.sym(this.webid),a("fn"));let t=window.location.protocol+"//"+window.location.host+"/assets/images/profile.png";this.profile.image=s.any($rdf.sym(this.webid),a("hasPhoto"))||$rdf.sym(t)}render(){return t("div",{class:"new-post"},t("h2",null,"Create New Post"),t("form",{onSubmit:this.createPost,class:"new-post-form"},t("textarea",{class:"new-post-form-input",ref:t=>this.postText=t})),t("div",null,t("button",{class:"post-button",type:"submit",onClick:this.createPost.bind(this)},"Create Post")))}static get is(){return"post-create"}static get encapsulation(){return"shadow"}static get properties(){return{webid:{type:String,attr:"webid"}}}static get style(){return".profile-image.sc-post-create{width:50px}.new-post.sc-post-create{max-width:200px;position:absolute;margin-left:10px}.new-post.sc-post-create   h2.sc-post-create{color:#555;margin-bottom:6px}.new-post-form-input.sc-post-create{width:200px;height:50px;border-radius:8px;margin-top:10px;border-color:#ccc}.post-list.sc-post-create{margin:10px;color:#555;font-family:sans-serif}.post-list.sc-post-create   h3.sc-post-create{text-decoration:underline;text-transform:uppercase;font-size:18px}.post-list-item.sc-post-create{width:400px;height:100px;overflow:auto;border:1px solid #ccc;padding:4px;margin-bottom:12px}.post-list-item-name.sc-post-create{font-size:16px;margin:8px 4px}.post-list-item-image.sc-post-create{float:left;margin-right:14px;margin-left:10px}.post-list-item-text.sc-post-create{font-size:12px;color:#333}.post-button.sc-post-create{background-color:#7c4dff;color:#fff;padding:6px 24px;cursor:pointer;border-radius:14px;margin-top:4px}"}}export{n as PostCreate};